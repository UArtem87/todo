let t="https://696f53afa06046ce618642cd.mockapi.io/tasks",e="https://696f53afa06046ce618642cd.mockapi.io/purchases";window.addEventListener("DOMContentLoaded",()=>{let a=[],n=null,s=e,i=document.querySelector(".header"),c=document.querySelector(".container"),o=document.querySelector(".title"),l=document.querySelector(".loader"),d=document.querySelector(".data__input"),r=document.querySelector(".data__btn"),u=document.querySelector(".items");async function m(e){e===t?o.textContent="Надо сделать:":o.textContent="Надо купить:",l.classList.remove("not-view");let n=await fetch(e),s=await n.json();s?(a=[],s.forEach(t=>{t.important?a.unshift(t):a.push(t)}),l.classList.add("not-view"),u.innerHTML="",a.forEach((t,e)=>{let a=`${t.text.slice(0,1).toUpperCase()}${t.text.slice(1)}`,n=document.createElement("div");n.setAttribute("id",t.id),n.classList.add("items__block");let s=document.createElement("span");s.classList.add("items__block--title"),s.textContent=`${e+1}. ${a}`;let i=document.createElement("span");i.classList.add("important"),i.innerHTML=t.important?"★":"☆",t.important&&i.classList.add("active");let c=document.createElement("span");c.classList.add("del");let o=document.createElement("span");o.classList.add("change"),o.innerHTML="&#9999",n.append(o,s,i,c),u.append(n)}),d.value="",u.classList.remove("faded")):a=[]}async function p(t){if(null!==n){if(""===d.value.trim())return void d.focus();await h(s,n,d.value),r.textContent="Сохранить",n=null}else if(""===d.value)d.focus();else{let e=d.value;await fetch(t,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({text:e})}),m(t)}}async function L(t,e){await fetch(`${t}/${e}`,{method:"DELETE"}),m(t)}async function f(t,e,a){await fetch(`${t}/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({important:a})}),m(t)}async function h(t,e,a){await fetch(`${t}/${e}`,{method:"PUT",headers:{"content-type":"application/json"},body:JSON.stringify({text:a})}),m(t)}document.addEventListener("click",t=>{let e=t.target,i=e.closest(".items__block");if(!i)return;let c=i.getAttribute("id");if(e.classList.contains("del")&&(i.classList.add("delete"),L(s,c)),e.classList.contains("important")){e.classList.toggle("active");let t=e.classList.contains("active");e.innerHTML=t?"★":"☆",f(s,c,t)}e.classList.contains("items__block--title")&&e.classList.toggle("expanded"),e.classList.contains("change")&&(n=c,d.value=a.find(t=>t.id===n).text,r.textContent="Обновить",d.focus())}),r.onclick=()=>p(s),d.onkeydown=t=>{"Enter"===t.key&&p(s)},i.addEventListener("click",a=>{n=null,r.textContent="Сохранить",d.value="";let i=a.target.classList.contains("tasks"),o=a.target.classList.contains("purchases");(i||o)&&(document.querySelectorAll(".view").forEach(t=>{t.classList.remove("active")}),a.target.classList.add("active"),document.querySelector(".main-title").classList.add("hidden"),c.classList.remove("hidden"),u.classList.add("faded"),setTimeout(()=>{m(s=i?t:e)},300))})});
//# sourceMappingURL=todo+.8eb9fbd7.js.map
